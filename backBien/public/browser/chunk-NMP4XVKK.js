import{a as D,e as q,f as R}from"./chunk-OWD3UF52.js";import{Ba as n,Ea as p,Ec as B,Fc as G,Gc as V,Hc as K,Ic as j,Jc as z,Ka as _,Kc as O,Na as h,Ob as C,Pb as I,Ua as d,Vb as y,Wc as L,Xa as a,Ya as e,Za as m,Zc as P,ab as S,bb as f,cb as b,d as J,ea as g,fa as E,fd as $,hc as N,ic as x,jc as k,kc as T,lb as r,mb as u,nb as v,oc as w,rc as M,uc as A}from"./chunk-UBFAJTUY.js";var c=J(K());function Q(l,i){if(l&1){let t=S();a(0,"tr")(1,"td"),r(2),e(),a(3,"td"),r(4),e(),a(5,"td"),r(6),e(),a(7,"td"),r(8),e(),a(9,"td")(10,"button",17),f("click",function(){let s=g(t).$implicit,F=b();return E(F.editar(s))}),m(11,"fa-icon",3),e(),a(12,"button",18),f("click",function(){let s=g(t).$implicit,F=b();return E(F.eliminar(s._id))}),m(13,"fa-icon",3),e()()()}if(l&2){let t=i.$implicit;n(2),u(t.nombre),n(2),u(t.direccion),n(2),u(t.telefono),n(2),u(t.firma),n(3),d("icon","pen"),n(2),d("icon","trash")}}function U(l,i){if(l&1&&(a(0,"form",19)(1,"div",20)(2,"label"),r(3,"Nombre:"),e(),m(4,"input",21),e(),a(5,"div",20)(6,"label"),r(7,"Direcci\xF3n:"),e(),m(8,"input",22),e(),a(9,"div",20)(10,"label"),r(11,"Tel\xE9fono:"),e(),m(12,"input",23),e(),a(13,"div",20)(14,"label"),r(15,"Firma:"),e(),m(16,"input",24),e()()),l&2){let t=b();d("formGroup",t.formFarmacia)}}var H=class l{constructor(i,t,o){this.fb=i;this.farmaciaService=t;this.library=o;o.addIcons(L,P,$),this.formFarmacia=this.fb.group({nombre:["",x.required],direccion:[""],telefono:[""],firma:["",x.required]})}formFarmacia;farmacias=[];guardando=!1;modoEdicion=!1;farmaciaEditandoId=null;ngOnInit(){this.cargarFarmacias()}cargarFarmacias(){this.farmaciaService.obtenerFarmacias().subscribe({next:i=>this.farmacias=i,error:()=>c.default.fire("Error","No se pudieron cargar las farmacias","error")})}abrirModalAgregar(){let i=document.getElementById("modalAgregarFarmacia");i?(this.formFarmacia.reset(),this.modoEdicion=!1,this.farmaciaEditandoId=null,new bootstrap.Modal(i,{backdrop:"static",keyboard:!1}).show()):console.error("No se encontr\xF3 el modal modalAgregarFarmacia")}editar(i){let t=document.getElementById("modalAgregarFarmacia");t&&(this.modoEdicion=!0,this.farmaciaEditandoId=i._id||null,this.formFarmacia.patchValue({nombre:i.nombre,direccion:i.direccion,telefono:i.telefono,firma:i.firma}),new bootstrap.Modal(t,{backdrop:"static",keyboard:!1}).show())}guardar(){if(this.formFarmacia.invalid||this.guardando)return;this.guardando=!0;let i=this.formFarmacia.value,t=()=>{let o=document.getElementById("modalAgregarFarmacia");o&&bootstrap.Modal.getInstance(o)?.hide(),this.formFarmacia.reset(),this.farmaciaEditandoId=null,this.modoEdicion=!1,this.guardando=!1,this.cargarFarmacias()};this.modoEdicion&&this.farmaciaEditandoId?this.farmaciaService.actualizarFarmacia(this.farmaciaEditandoId,i).subscribe({next:()=>c.default.fire("Actualizado","Farmacia actualizada correctamente","success").then(t),error:()=>{c.default.fire("Error","No se pudo actualizar","error"),this.guardando=!1}}):this.farmaciaService.crearFarmacia(i).subscribe({next:()=>c.default.fire("Creado","Farmacia creada correctamente","success").then(t),error:()=>{c.default.fire("Error","No se pudo crear","error"),this.guardando=!1}})}eliminar(i){c.default.fire({title:"\xBFEst\xE1s seguro?",text:"La farmacia ser\xE1 desactivada",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xED, eliminar",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&this.farmaciaService.eliminarFarmacia(i).subscribe({next:()=>{c.default.fire("Desactivada","La farmacia fue desactivada","success"),this.cargarFarmacias()},error:()=>c.default.fire("Error","No se pudo eliminar la farmacia","error")})})}static \u0275fac=function(t){return new(t||l)(p(B),p(D),p(j))};static \u0275cmp=_({type:l,selectors:[["app-farmacias"]],decls:35,vars:6,consts:[[1,"container","mt-4"],[1,"titulo"],[1,"btn-verde","mb-3",3,"click"],[3,"icon"],[1,"tabla"],[4,"ngFor","ngForOf"],["id","modalAgregarFarmacia","tabindex","-1","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content","p-3",2,"background-color","azure"],[1,"modal-header"],[1,"modal-title","titulo"],["type","button","data-bs-dismiss","modal","aria-label","Cerrar",1,"btn-close"],[1,"modal-body"],[3,"formGroup",4,"ngIf"],[1,"modal-footer","d-flex","justify-content-between"],["data-bs-dismiss","modal",1,"btn-rojo"],[1,"btn-gris",3,"click","disabled"],["matTooltip","Editar",1,"btn-icon-chico","btn-gris-chico",3,"click"],["matTooltip","Eliminar",1,"btn-icon-chico","btn-rojo-chico",3,"click"],[3,"formGroup"],[1,"mb-2"],["type","text","formControlName","nombre",1,"form-control"],["type","text","formControlName","direccion",1,"form-control"],["type","text","formControlName","telefono",1,"form-control"],["type","text","formControlName","firma",1,"form-control"]],template:function(t,o){t&1&&(a(0,"div",0)(1,"h2",1),r(2,"Mantenimiento de Farmacias"),e(),a(3,"button",2),f("click",function(){return o.abrirModalAgregar()}),m(4,"fa-icon",3),r(5," Agregar Farmacia "),e(),a(6,"table",4)(7,"thead")(8,"tr")(9,"th"),r(10,"Nombre"),e(),a(11,"th"),r(12,"Direcci\xF3n"),e(),a(13,"th"),r(14,"Tel\xE9fono"),e(),a(15,"th"),r(16,"Firma"),e(),a(17,"th"),r(18,"Acciones"),e()()(),a(19,"tbody"),h(20,Q,14,6,"tr",5),e()(),a(21,"div",6)(22,"div",7)(23,"div",8)(24,"div",9)(25,"h5",10),r(26),e(),m(27,"button",11),e(),a(28,"div",12),h(29,U,17,1,"form",13),e(),a(30,"div",14)(31,"button",15),r(32,"Cancelar"),e(),a(33,"button",16),f("click",function(){return o.guardar()}),r(34),e()()()()()()),t&2&&(n(4),d("icon","plus"),n(16),d("ngForOf",o.farmacias),n(6),v(" ",o.modoEdicion?"Editar farmacia":"Agregar nueva farmacia"," "),n(3),d("ngIf",o.formFarmacia),n(4),d("disabled",o.formFarmacia.invalid||o.guardando),n(),v(" ",o.guardando?"Guardando...":o.modoEdicion?"Actualizar":"Guardar"," "))},dependencies:[y,C,I,O,z,V,w,N,k,T,M,A,G,R,q],encapsulation:2})};export{H as FarmaciasComponent};
