import{$c as L,Ab as u,Bc as U,Bd as I,Ec as z,Fc as A,Fd as X,Ja as r,Jc as G,Lb as C,Mb as x,Mc as O,Na as E,Nb as j,Pb as w,Pc as P,Ua as F,Xa as h,Zc as $,_c as R,ad as te,bd as q,cb as m,cd as J,d as ee,dd as K,ec as D,fc as T,gb as i,gd as Q,hb as t,ia as f,ib as d,ja as _,jc as V,lb as g,lc as k,mc as N,nb as b,ob as p,od as W,rc as H,tc as M,yb as S,yc as B,zb as o}from"./chunk-3TU753TR.js";var Z=ee(te());function ie(a,c){if(a&1){let e=g();i(0,"button",17),b("click",function(){let n;f(e);let l=p();return _((n=l.filtroForm.get("fechaInicioDesde"))==null?null:n.setValue(""))}),d(1,"fa-icon",18),t()}if(a&2){let e=p();r(),m("icon",e.faTimes)}}function ne(a,c){if(a&1){let e=g();i(0,"button",17),b("click",function(){let n;f(e);let l=p();return _((n=l.filtroForm.get("fechaInicioHasta"))==null?null:n.setValue(""))}),d(1,"fa-icon",18),t()}if(a&2){let e=p();r(),m("icon",e.faTimes)}}function oe(a,c){if(a&1){let e=g();i(0,"button",19),b("click",function(){let n;f(e);let l=p();return _((n=l.filtroForm.get("nombreUsuario"))==null?null:n.setValue(""))}),d(1,"fa-icon",18),t()}if(a&2){let e=p();r(),m("icon",e.faTimes)}}function re(a,c){if(a&1){let e=g();i(0,"tr")(1,"td"),o(2),t(),i(3,"td"),o(4),C(5,"currency"),t(),i(6,"td"),o(7),C(8,"currency"),t(),i(9,"td"),o(10),C(11,"currency"),t(),i(12,"td"),o(13),C(14,"currency"),t(),i(15,"td"),o(16),C(17,"currency"),t(),i(18,"td"),o(19),C(20,"currency"),t(),i(21,"td"),o(22),C(23,"date"),t(),i(24,"td")(25,"button",23),b("click",function(){let n=f(e).$implicit,l=p(2);return _(l.autorizarTurnoExtra(n))}),d(26,"fa-icon",18),t(),i(27,"button",24),b("click",function(){let n=f(e).$implicit,l=p(2);return _(l.mostrarDetalle(n))}),d(28,"fa-icon",18),t(),i(29,"button",25),b("click",function(){let n=f(e).$implicit,l=p(2);return _(l.vistaPreviaFinalizar(n))}),d(30,"fa-icon",18),t()()()}if(a&2){let e=c.$implicit;r(2),u((e.usuario==null?null:e.usuario.nombre)||"N/A"),r(2),u(x(5,12,e.efectivoInicial)),r(3),u(x(8,14,e.totalEfectivoEnCaja)),r(3),u(x(11,16,e.totalTarjeta)),r(3),u(x(14,18,e.totalTransferencia)),r(3),u(x(17,20,e.totalVale)),r(3),u(x(20,22,e.abonosMonederos)),r(3),u(e.fechaFin?j(23,24,e.fechaFin,"dd/MM/yyyy HH:mm"):"abierto"),r(3),m("disabled",e.turnoExtraAutorizado),r(),m("icon","user-check"),r(2),m("icon","eye"),r(2),m("icon","file-invoice")}}function ae(a,c){if(a&1&&(i(0,"div",20)(1,"table",21)(2,"thead")(3,"tr")(4,"th"),o(5,"Usuario"),t(),i(6,"th"),o(7,"Efec. inicial"),t(),i(8,"th"),o(9,"Efectivo"),t(),i(10,"th"),o(11,"Tarjeta"),t(),i(12,"th"),o(13,"Transferencia"),t(),i(14,"th"),o(15,"Monedero"),t(),i(16,"th"),o(17,"Abonos Monedero"),t(),i(18,"th"),o(19,"Fecha Fin"),t(),i(20,"th"),o(21,"Acciones"),t()()(),i(22,"tbody"),h(23,re,31,27,"tr",22),t()()()),a&2){let e=p();r(23),m("ngForOf",e.cortes)}}function le(a,c){a&1&&(i(0,"p",26),o(1,"No hay cortes de caja para mostrar."),t())}var Y=class a{constructor(c,e,s){this.http=c;this.fb=e;let n=new Date().toISOString().substring(0,10);this.filtroForm=this.fb.group({fechaInicioDesde:[n],fechaInicioHasta:[n],nombreUsuario:[""]}),s.addIcons(Q,W,X,I)}fechaInicioDesde="";fechaInicioHasta="";filtroUsuario="";cortes=[];filtroForm;cargando=!1;faTimes=I;ngOnInit(){this.buscarCortes()}buscarCortes(){let c=localStorage.getItem("auth_token")||"",e=new H({"x-auth-token":c}),{fechaInicioDesde:s,fechaInicioHasta:n,nombreUsuario:l}=this.filtroForm.value,v={fechaInicioDesde:s,fechaInicioHasta:n};l&&l.trim().length>2&&(v.nombreUsuario=l.trim()),this.cargando=!0,this.http.get(`${B.apiUrl}/cortes/filtrados`,{headers:e,params:v}).subscribe({next:y=>{this.cortes=y.cortes,this.cargando=!1},error:y=>{console.error("Error al buscar cortes:",y),Z.default.fire("Error","No se pudieron cargar los cortes de caja.","error"),this.cargando=!1}})}autorizarTurnoExtra(c){console.log("Autorizar turno extra para:",c)}mostrarDetalle(c){console.log("Mostrar detalle:",c)}vistaPreviaFinalizar(c){console.log("Vista previa de finalizaci\xF3n:",c)}static \u0275fac=function(e){return new(e||a)(E(M),E($),E(q))};static \u0275cmp=F({type:a,selectors:[["app-cortes-de-caja"]],decls:29,vars:6,consts:[["sinResultados",""],[1,"cortes-caja-container"],[1,"titulo-container"],[1,"titulo"],[1,"row","mb-2",3,"formGroup"],[1,"col-md-3"],[1,"d-flex","align-items-center","position-relative","w-100"],[1,"me-2","mb-0",2,"white-space","nowrap"],["type","date","formControlName","fechaInicioDesde",1,"form-control","pe-5","flex-grow-1"],["type","button","class","btn-icon-chico btn-sm btn-light position-absolute top-50 end-0 translate-middle-y btn-rojo-chico","style","z-index: 2; margin-right: 6px;",3,"click",4,"ngIf"],["type","date","formControlName","fechaInicioHasta",1,"form-control","pe-5","flex-grow-1"],[1,"col-md-4"],["type","text","formControlName","nombreUsuario",1,"form-control","pe-4","flex-grow-1"],["type","button","class","btn-icon-chico btn-sm btn-light position-absolute top-50 end-0 translate-middle-y btn-rojo-chico",3,"click",4,"ngIf"],[1,"col-md-2"],[1,"btn-gris",3,"click"],["class","mt-3 d-flex justify-content-center",4,"ngIf","ngIfElse"],["type","button",1,"btn-icon-chico","btn-sm","btn-light","position-absolute","top-50","end-0","translate-middle-y","btn-rojo-chico",2,"z-index","2","margin-right","6px",3,"click"],[3,"icon"],["type","button",1,"btn-icon-chico","btn-sm","btn-light","position-absolute","top-50","end-0","translate-middle-y","btn-rojo-chico",3,"click"],[1,"mt-3","d-flex","justify-content-center"],[1,"tabla","mx-auto"],[4,"ngFor","ngForOf"],["matTooltip","Autorizar turno extra",1,"btn-icon-chico","btn-gris-chico",3,"click","disabled"],["matTooltip","Ver detalle",1,"btn-icon-chico","btn-verde-chico",3,"click"],["matTooltip","Vista previa corte",1,"btn-icon-chico","btn-amarillo-chico",3,"click"],[2,"color","brown"]],template:function(e,s){if(e&1){let n=g();i(0,"div",1)(1,"div",2)(2,"h1",3),o(3,"Cortes de Caja"),t()(),i(4,"form",4)(5,"div",5)(6,"div",6)(7,"label",7),o(8,"Desde:"),t(),d(9,"input",8),h(10,ie,2,1,"button",9),t()(),i(11,"div",5)(12,"div",6)(13,"label",7),o(14,"Hasta:"),t(),d(15,"input",10),h(16,ne,2,1,"button",9),t()(),i(17,"div",11)(18,"div",6)(19,"label",7),o(20,"Usuario:"),t(),d(21,"input",12),h(22,oe,2,1,"button",13),t()(),i(23,"div",14)(24,"button",15),b("click",function(){return f(n),_(s.buscarCortes())}),o(25,"Buscar"),t()()(),h(26,ae,24,1,"div",16)(27,le,2,0,"ng-template",null,0,w),t()}if(e&2){let n,l,v,y=S(28);r(4),m("formGroup",s.filtroForm),r(6),m("ngIf",(n=s.filtroForm.get("fechaInicioDesde"))==null?null:n.value),r(6),m("ngIf",(l=s.filtroForm.get("fechaInicioHasta"))==null?null:l.value),r(6),m("ngIf",(v=s.filtroForm.get("nombreUsuario"))==null?null:v.value),r(4),m("ngIf",s.cortes&&s.cortes.length>0)("ngIfElse",y)}},dependencies:[N,D,T,k,V,R,G,U,z,A,L,O,P,K,J],encapsulation:2})};export{Y as CortesDeCajaComponent};
